import * as test from 'tape';
import { fromPoint, fromPolygon } from '../src';

test('Point', t => {
  const point = {
    "type": "Feature",
    "properties": {},
    "geometry": {
      "type": "Point",
      "coordinates": [
        -0.5264854431152344,
        51.46074549284468
      ]
    }
  }
  
  t.deepEqual(fromPoint(point, 10), [510, 340])
  t.end()
})

test('Polygon', t => {
  const polygon = {
    "type": "Feature",
    "properties": {},
    "geometry": {
      "type": "Polygon",
      "coordinates": [
        [
          [
            -0.5331802368164062,
            51.45721588307605
          ],
          [
            -0.5139541625976562,
            51.45721588307605
          ],
          [
            -0.5139541625976562,
            51.46962178962983
          ],
          [
            -0.5331802368164062,
            51.46962178962983
          ],
          [
            -0.5331802368164062,
            51.45721588307605
          ]
        ]
      ]
    }
  }
  
  t.deepEqual(fromPolygon(polygon, 10), [[510, 340]])
  
  const polygon2 = {
    "type": "Feature",
    "properties": {},
    "geometry": {
      "type": "Polygon",
      "coordinates": [
        [
          [
            -0.4785490036010742,
            51.53312244116709
          ],
          [
            -0.478527545928955,
            51.53295559080129
          ],
          [
            -0.47432184219360346,
            51.53291554662249
          ],
          [
            -0.4743003845214844,
            51.53323589906647
          ],
          [
            -0.46985864639282227,
            51.53326926898307
          ],
          [
            -0.46980500221252436,
            51.533569597131624
          ],
          [
            -0.47462224960327143,
            51.533542901376435
          ],
          [
            -0.47460079193115234,
            51.53315581116684
          ],
          [
            -0.4785490036010742,
            51.53312244116709
          ]
        ]
      ]
    }
  }
  
  t.deepEqual(fromPolygon(polygon2, 16), [ [ 32680, 21784 ], [ 32681, 21784 ], [ 32682, 21784 ] ])
  
  const polygon3 = {
    "type": "Feature",
    "properties": {},
    "geometry": {
      "type": "Polygon",
      "coordinates": [
        [
          [
            -0.4076528549194336,
            51.499366177145816
          ],
          [
            -0.4069232940673828,
            51.50094238217541
          ],
          [
            -0.41027069091796875,
            51.50219796412196
          ],
          [
            -0.4127168655395508,
            51.503186376638006
          ],
          [
            -0.4147768020629883,
            51.50428161952125
          ],
          [
            -0.41825294494628906,
            51.505804230524056
          ],
          [
            -0.42258739471435547,
            51.506979544573035
          ],
          [
            -0.4303550720214844,
            51.509570470731695
          ],
          [
            -0.43323040008544916,
            51.509784148786515
          ],
          [
            -0.4364490509033203,
            51.5089561407416
          ],
          [
            -0.440826416015625,
            51.5081548283056
          ],
          [
            -0.4452896118164062,
            51.50788772102843
          ],
          [
            -0.45335769653320307,
            51.50911640153762
          ],
          [
            -0.4572200775146485,
            51.509837568143645
          ],
          [
            -0.4682493209838867,
            51.51093265116127
          ],
          [
            -0.4717254638671875,
            51.51165378901763
          ],
          [
            -0.47460079193115234,
            51.51373701203605
          ],
          [
            -0.476531982421875,
            51.51638096559901
          ],
          [
            -0.4808235168457031,
            51.51990599829348
          ],
          [
            -0.4829263687133789,
            51.52158830408364
          ],
          [
            -0.48472881317138666,
            51.52521973645372
          ],
          [
            -0.4843425750732422,
            51.52770282862996
          ],
          [
            -0.48425674438476557,
            51.52925135518991
          ],
          [
            -0.48498630523681635,
            51.532134678095346
          ],
          [
            -0.4861879348754882,
            51.5347775636716
          ],
          [
            -0.48653125762939453,
            51.538621486960956
          ],
          [
            -0.4886770248413086,
            51.53870156524414
          ],
          [
            -0.4887199401855469,
            51.53712666647916
          ],
          [
            -0.4888486862182617,
            51.535044513278166
          ],
          [
            -0.48773288726806646,
            51.53309574514964
          ],
          [
            -0.4872608184814453,
            51.5303993667449
          ],
          [
            -0.48653125762939453,
            51.52893097470561
          ],
          [
            -0.48713207244873047,
            51.52735573786512
          ],
          [
            -0.4872608184814453,
            51.5255134425896
          ],
          [
            -0.48588752746582026,
            51.522095653950174
          ],
          [
            -0.4839134216308594,
            51.51979918312931
          ],
          [
            -0.4818534851074219,
            51.51776964741072
          ],
          [
            -0.4788494110107422,
            51.515526371131976
          ],
          [
            -0.47876358032226557,
            51.514030792232774
          ],
          [
            -0.47627449035644526,
            51.512241374386456
          ],
          [
            -0.47425746917724604,
            51.51087923308819
          ],
          [
            -0.47121047973632807,
            51.50959718054333
          ],
          [
            -0.4578208923339843,
            51.5077274559105
          ],
          [
            -0.44837951660156244,
            51.506098061878475
          ],
          [
            -0.44322967529296875,
            51.50588436653591
          ],
          [
            -0.4367494583129883,
            51.506845987685146
          ],
          [
            -0.43314456939697266,
            51.507941142609155
          ],
          [
            -0.4304838180541992,
            51.507300079506656
          ],
          [
            -0.42524814605712885,
            51.50591107850855
          ],
          [
            -0.41992664337158203,
            51.50369393149093
          ],
          [
            -0.4133176803588867,
            51.50104924156018
          ],
          [
            -0.4076528549194336,
            51.499366177145816
          ]
        ]
      ]
    }
  }
  
  t.deepEqual(fromPolygon(polygon3, 16, true),  [ [ 32679, 21783 ], [ 32679, 21784 ], [ 32679, 21785 ], [ 32679, 21786 ], [ 32679, 21787 ], [ 32679, 21788 ], [ 32680, 21787 ], [ 32680, 21788 ], [ 32680, 21789 ], [ 32680, 21790 ], [ 32681, 21789 ], [ 32681, 21790 ], [ 32681, 21791 ], [ 32682, 21791 ], [ 32683, 21791 ], [ 32683, 21792 ], [ 32684, 21791 ], [ 32684, 21792 ], [ 32685, 21791 ], [ 32685, 21792 ], [ 32686, 21792 ], [ 32687, 21792 ], [ 32688, 21791 ], [ 32688, 21792 ], [ 32689, 21791 ], [ 32689, 21792 ], [ 32690, 21791 ], [ 32690, 21792 ], [ 32690, 21793 ], [ 32691, 21792 ], [ 32691, 21793 ], [ 32692, 21792 ], [ 32692, 21793 ], [ 32692, 21794 ], [ 32693, 21793 ], [ 32693, 21794 ] ])
  t.end()
})
